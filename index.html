<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·ªãch Ng√†y ƒê·∫πp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            padding: 30px 20px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.8);
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            padding: 12px 18px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease;
        }

        .control-group:hover {
            transform: translateY(-2px);
        }

        .control-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }

        select, input {
            border: none;
            background: transparent;
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            outline: none;
            cursor: pointer;
        }

        input[type="number"] {
            width: 80px;
            text-align: center;
        }

        .calendar-container {
            padding: 20px;
            overflow-x: auto;
        }

        .current-month {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 700;
            color: #444;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, minmax(50px, 1fr));
            gap: 6px;
            max-width: 100%;
            margin: 0 auto;
            min-width: 350px;
        }

        .calendar-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 2px;
            text-align: center;
            font-weight: 700;
            font-size: 0.9rem;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
            min-width: 50px;
        }

        .calendar-day {
            background: white;
            border-radius: 8px;
            padding: 8px 4px;
            text-align: center;
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            min-width: 50px;
        }

        .calendar-day:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }

        .calendar-day.selected {
            border-color: #e74c3c;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
        }

        .calendar-day.empty {
            background: transparent;
            box-shadow: none;
            cursor: default;
        }

        .calendar-day.empty:hover {
            transform: none;
        }

        .solar-date {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 3px;
        }

        .lunar-date {
            font-size: 0.75rem;
            color: #e74c3c;
            font-weight: 600;
            background: rgba(231, 76, 60, 0.1);
            padding: 2px 6px;
            border-radius: 8px;
            line-height: 1.2;
            margin-bottom: 3px;
        }

        .lunar-date.leap {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            animation: pulse 2s infinite;
        }

        .can-chi {
            font-size: 0.7rem;
            color: #2ecc71;
            font-weight: 600;
            background: rgba(46, 204, 113, 0.1);
            padding: 2px 6px;
            border-radius: 8px;
            line-height: 1.2;
        }

        .good-day {
            font-size: 0.9rem;
            color: #f1c40f;
            margin-top: 3px;
        }

        .bad-day {
            font-size: 0.9rem;
            color: #000000;
            margin-top: 3px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .today {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e) !important;
            border-color: #e17055 !important;
            box-shadow: 0 8px 25px rgba(225, 112, 85, 0.3) !important;
        }

        .today .solar-date {
            color: #d63031;
        }

        .weekend {
            background: linear-gradient(135deg, #fab1a0, #e17055);
        }

        .weekend .solar-date {
            color: white;
        }

        .weekend .lunar-date, .weekend .can-chi {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .day-info-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .day-info-container h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .day-info-container .day-info {
            font-size: 1rem;
            color: #555;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .day-info-container .hours-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .day-info-container .hours-table th,
        .day-info-container .hours-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            font-size: 0.9rem;
        }

        .day-info-container .hours-table th {
            background: #f4f4f4;
            font-weight: 600;
        }

        .day-info-container .hours-table .good-hour {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .day-info-container .hours-table .bad-hour {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                gap: 10px;
            }

            .control-group {
                width: 100%;
                justify-content: center;
            }

            .calendar {
                gap: 4px;
                min-width: 320px;
            }

            .calendar-header {
                font-size: 0.8rem;
                padding: 8px 2px;
            }

            .calendar-day {
                min-height: 80px;
                padding: 6px 2px;
                min-width: 45px;
            }

            .solar-date {
                font-size: 1.1rem;
            }

            .lunar-date, .can-chi {
                font-size: 0.7rem;
                padding: 2px 4px;
            }

            .good-day, .bad-day {
                font-size: 0.8rem;
            }

            .day-info-container {
                margin: 10px;
                padding: 15px;
            }

            .day-info-container h3 {
                font-size: 1.3rem;
            }

            .day-info-container .day-info {
                font-size: 0.9rem;
            }

            .day-info-container .hours-table th,
            .day-info-container .hours-table td {
                font-size: 0.8rem;
                padding: 6px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 5px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .calendar {
                gap: 3px;
                min-width: 300px;
            }

            .calendar-header {
                font-size: 0.7rem;
                padding: 6px 1px;
            }

            .calendar-day {
                min-height: 70px;
                padding: 4px 1px;
                min-width: 40px;
            }

            .solar-date {
                font-size: 1rem;
            }

            .lunar-date, .can-chi {
                font-size: 0.65rem;
                padding: 1px 3px;
            }

            .good-day, .bad-day {
                font-size: 0.7rem;
            }

            .day-info-container {
                margin: 5px;
                padding: 10px;
            }

            .day-info-container h3 {
                font-size: 1.2rem;
            }

            .day-info-container .day-info {
                font-size: 0.85rem;
            }

            .day-info-container .hours-table th,
            .day-info-container .hours-table td {
                font-size: 0.75rem;
                padding: 5px;
            }
        }

        .calendar-day {
            animation: fadeInUp 0.6s ease forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .calendar-day:nth-child(8) { animation-delay: 0.1s; }
        .calendar-day:nth-child(9) { animation-delay: 0.2s; }
        .calendar-day:nth-child(10) { animation-delay: 0.3s; }
        .calendar-day:nth-child(11) { animation-delay: 0.4s; }
        .calendar-day:nth-child(12) { animation-delay: 0.5s; }
        .calendar-day:nth-child(13) { animation-delay: 0.6s; }
        .calendar-day:nth-child(14) { animation-delay: 0.7s; }
        
        .birth-input-section {
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .birth-input-section h3 {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .birth-form {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            align-items: center;
        }
        
        .birth-form select {
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            min-width: 100px;
        }
        
        .birth-form input[type="number"] {
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            width: 120px;
            text-align: center;
        }
        
        .birth-form button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .birth-form button:hover {
            transform: translateY(-2px);
        }
        
        .menh-info {
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            border-radius: 10px;
            text-align: center;
        }
        
        .menh-info p {
            margin: 5px 0;
            font-size: 1rem;
            font-weight: 600;
            color: #333;
        }
        
        .analysis-section {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 2px solid #667eea;
        }
        
        .analysis-section h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .analysis-item {
            margin: 10px 0;
            padding: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .analysis-item.warning {
            background: rgba(231, 76, 60, 0.1);
            border-left-color: #e74c3c;
        }
        
        .analysis-item.good {
            background: rgba(46, 204, 113, 0.1);
            border-left-color: #2ecc71;
        }

        .analysis-item.neutral {
            background: rgba(149, 165, 166, 0.1);
            border-left-color: #95a5a6;
        }
        
        .analysis-item strong {
            color: #333;
            display: block;
            margin-bottom: 5px;
        }
        
        .analysis-item span {
            color: #666;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåô Xem Ng√†y ƒê·∫πp</h1>
            <p> ‚≠ê Ng√†y ƒë·∫πp ‚òÖ Ng√†y x·∫•u. ·∫§n v√†o ng√†y ƒë·ªÉ xem di·ªÖn gi·∫£i ph√≠a d∆∞·ªõi l·ªãch </p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label>üìÖ Th√°ng:</label>
                <select id="month" onchange="renderCalendar()">
                    <option value="1">Th√°ng 1</option>
                    <option value="2">Th√°ng 2</option>
                    <option value="3">Th√°ng 3</option>
                    <option value="4">Th√°ng 4</option>
                    <option value="5">Th√°ng 5</option>
                    <option value="6">Th√°ng 6</option>
                    <option value="7">Th√°ng 7</option>
                    <option value="8">Th√°ng 8</option>
                    <option value="9">Th√°ng 9</option>
                    <option value="10">Th√°ng 10</option>
                    <option value="11">Th√°ng 11</option>
                    <option value="12">Th√°ng 12</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>üóìÔ∏è NƒÉm:</label>
                <input type="number" id="year" value="" min="1900" max="2100" onchange="renderCalendar()">
            </div>
        </div>
        
        <div class="birth-input-section">
            <h3>üéÇ Nh·∫≠p Ng√†y Sinh Gia Ch·ªß (ƒë·ªÉ xem ph√¢n t√≠ch chi ti·∫øt)</h3>
            <div class="birth-form">
                <select id="birthDay">
                    <option value="">Ch·ªçn ng√†y</option>
                </select>
                <select id="birthMonth">
                    <option value="">Ch·ªçn th√°ng</option>
                </select>
                <input type="number" id="birthYear" placeholder="NƒÉm" min="1900" max="2100">
                <button onclick="calculateMenh()">T√≠nh M·ªánh</button>
                <button onclick="clearMenh()">X√≥a</button>
            </div>
            <div id="menhDisplay" style="display: none;" class="menh-info"></div>
        </div>            
        
        <div class="calendar-container">
            <div class="current-month" id="currentMonth"></div>
            <div class="calendar" id="calendar"></div>
            <div class="day-info-container" id="dayInfo">
                <h3>Ch·ªçn m·ªôt ng√†y</h3>
                <p class="day-info">Vui l√≤ng ch·ªçn m·ªôt ng√†y tr√™n l·ªãch ƒë·ªÉ xem th√¥ng tin ng√†y t·ªët/x·∫•u v√† gi·ªù t·ªët/x·∫•u.</p>
            </div>
        </div>
    </div>

    <script>
        // Danh s√°ch ng√†y t·ªët/x·∫•u
        const goodBadDays = [
            { name: "B·∫£o Th∆∞∆°ng - Ng√†y t·ªët", days: [6, 12, 18, 24, 30], months: [1, 4, 7, 10], description: "Ng√†y ƒë·∫πp, xu·∫•t h√†nh thu·∫≠n l·ª£i, l√†m ƒë∆∞·ª£c vi·ªác nh∆∞ mong mu·ªën, g·∫∑p ng∆∞·ªùi l·ªõn v·ª´a l√≤ng." },
            { name: "ƒê∆∞·ªùng Phong - Ng√†y t·ªët", days: [1, 7, 13, 19, 25], months: [1, 4, 7, 10], description: "Ng√†y ƒë·∫πp, xu·∫•t h√†nh thu·∫≠n l·ª£i, g·∫∑p ƒë∆∞·ª£c qu√Ω nh√¢n ph√π tr·ª£ v√† c·∫ßu t√†i ƒë∆∞·ª£c nh∆∞ √Ω." },
            { name: "Kim D∆∞∆°ng - Ng√†y t·ªët", days: [3, 9, 15, 21, 27], months: [1, 4, 7, 10], description: "Xu·∫•t h√†nh v√† l√∫c v·ªÅ ƒë·ªÅu t·ªët, g·∫∑p ƒë∆∞·ª£c nhi·ªÅu thu·∫≠n l·ª£i, nh·∫≠n ƒë∆∞·ª£c s·ª± gi√∫p ƒë·ª° t·ª´ ng∆∞·ªùi kh√°c, g·∫∑p may m·∫Øn trong c√°c cu·ªôc tranh lu·∫≠n, c·∫ßu t√†i ƒë∆∞·ª£c nh∆∞ √Ω." },
            { name: "Thu·∫ßn D∆∞∆°ng - Ng√†y t·ªët", days: [4, 10, 16, 22, 28], months: [1, 4, 7, 10], description: "Xu·∫•t h√†nh v√† l√∫c v·ªÅ ƒë·ªÅu t·ªët, g·∫∑p ƒë∆∞·ª£c nhi·ªÅu thu·∫≠n l·ª£i, nh·∫≠n ƒë∆∞·ª£c s·ª± gi√∫p ƒë·ª° t·ª´ ng∆∞·ªùi kh√°c, g·∫∑p may m·∫Øn trong c√°c cu·ªôc tranh lu·∫≠n, c·∫ßu t√†i ƒë∆∞·ª£c nh∆∞ √Ω." },
            { name: "ƒê·∫°o T·∫∑c - Ng√†y x·∫•u", days: [5, 11, 17, 23, 29], months: [1, 4, 7, 10], description: "L√† ng√†y x·∫•u, n·∫øu xu·∫•t h√†nh s·∫Ω b·ªã h·∫°i, d·ªÖ b·ªã m·∫•t c·ªßa." },
            { name: "Kim Th·ªï - Ng√†y x·∫•u", days: [2, 8, 14, 20, 26], months: [1, 4, 7, 10], description: "Xu·∫•t h√†nh d·ªÖ b·ªã nh·ª° chuy·∫øn t√†u xe, tr√™n ƒë∆∞·ªùng ƒëi d·ªÖ g·∫∑p b·∫•t l·ª£i, b·ªã m·∫•t c·ªßa, kh√≥ c·∫ßu t√†i." },
            { name: "Thi√™n T√†i - Ng√†y t·ªët", days: [4, 12, 20, 28], months: [2, 5, 8, 11], description: "N√™n xu·∫•t h√†nh, c·∫ßu t√†i ƒë∆∞·ª£c th·∫Øng l·ª£i v√† ƒë∆∞·ª£c nhi·ªÅu ng∆∞·ªùi gi√∫p ƒë·ª°, c√¥ng vi·ªác thu·∫≠n l·ª£i." },
            { name: "Thi√™n D∆∞∆°ng - Ng√†y t·ªët", days: [6, 14, 22], months: [2, 5, 8, 11], description: "Xu·∫•t h√†nh t·ªët, c·∫ßu t√†i ƒë∆∞·ª£c t√†i. H·ªèi v·ª£ ƒë∆∞·ª£c v·ª£. M·ªçi vi·ªác ƒë·ªÅu nh∆∞ √Ω mu·ªën." },
            { name: "Thi√™n Th∆∞∆°ng - Ng√†y t·ªët", days: [8, 16, 24, 30], months: [2, 5, 8, 11], description: "Xu·∫•t h√†nh ƒë·ªÉ g·∫∑p c·∫•p tr√™n th√¨ tuy·ªát v·ªùi, c·∫ßu t√†i th√¨ ƒë∆∞·ª£c t√†i. M·ªçi vi·ªác ƒë·ªÅu thu·∫≠n l·ª£i." },
            { name: "Thi√™n ƒê∆∞·ªùng - Ng√†y t·ªët", days: [3, 11, 19, 27], months: [2, 5, 8, 11], description: "Xu·∫•t h√†nh t·ªët, m·ªçi vi·ªác ƒë∆∞·ª£c nh∆∞ √Ω v√† g·∫∑p ƒë∆∞·ª£c qu√Ω nh√¢n ph√π tr·ª£, n·∫øu xu·∫•t h√†nh bu√¥n b√°n th√¨ mua may v√† b√°n ƒë·∫Øt." },
            { name: "Thi√™n M√¥n - Ng√†y t·ªët", days: [2, 10, 18, 26], months: [2, 5, 8, 11], description: "Xu·∫•t h√†nh thu·∫≠n l·ª£i, c·∫ßu ƒë∆∞·ª£c ∆∞·ªõc th·∫•y v√† m·ªçi vi·ªác d·ªÖ th√†nh c√¥ng." },
            { name: "Thi√™n ƒê·∫°o - Ng√†y x·∫•u", days: [1, 9, 17, 25], months: [2, 5, 8, 11], description: "N·∫øu l√† xu·∫•t h√†nh c·∫ßu t√†i th√¨ n√™n tr√°nh v√¨ d√π ƒë∆∞·ª£c th√¨ c≈©ng d·ªÖ b·ªã t·ªën k√©m ho·∫∑c d·ªÖ b·ªã y·∫øu l√Ω m√† thua thi·ªát." },
            { name: "Thi√™n T·∫∑c - Ng√†y x·∫•u", days: [5, 13, 21, 29], months: [2, 5, 8, 11], description: "Kh√¥ng t·ªët ƒë·ªÉ xu·∫•t h√†nh, m·ªçi chuy·ªán g·∫∑p ph·∫£i d·ªÖ r∆°i v√†o t√¨nh hu·ªëng x·∫•u, kh√¥ng th√≠ch h·ª£p ƒë·ªÉ xu·∫•t h√†nh c·∫ßu t√†i." },
            { name: "Thi√™n H·∫ßu - Ng√†y x·∫•u", days: [7, 15, 23], months: [2, 5, 8, 11], description: "N·∫øu xu·∫•t h√†nh th√¨ d·ªÖ r∆°i v√†o t√¨nh tr·∫°ng c√£i nhau, th·∫≠m ch√≠ c√≥ th·ªÉ x·∫£y ra tai n·∫°n ƒë·ªï m√°u." },
            { name: "B·∫°ch H·ªï ƒê·∫ßu - Ng√†y t·ªët", days: [2, 10, 18, 26], months: [3, 6, 9, 12], description: "Xu·∫•t h√†nh c·∫ßu t√†i ho·∫∑c ƒëi b·∫•t c·ª© ƒë√¢u ƒë·ªÅu r·∫•t thu·∫≠n l·ª£i." },
            { name: "B·∫°ch H·ªï Ki·∫øp - Ng√†y t·ªët", days: [3, 11, 19, 27], months: [3, 6, 9, 12], description: "Xu·∫•t h√†nh ƒëi theo h∆∞·ªõng B·∫Øc ho·∫∑c Nam ƒë·ªÅu thu·∫≠n l·ª£i, c√≥ th·ªÉ xu·∫•t h√†nh c·∫ßu t√†i ƒë·ªÉ ƒë∆∞·ª£c nh∆∞ √Ω." },
            { name: "Thanh Long Ki·∫øp - Ng√†y t·ªët", days: [7, 15, 23], months: [3, 6, 9, 12], description: "Xu·∫•t h√†nh ƒëi 3 ph∆∞∆°ng 4 h∆∞·ªõng ƒë·ªÅu r·∫•t t·ªët, m·ªçi s·ª± ƒë·ªÅu su√¥n s·∫ª nh∆∞ √Ω." },
            { name: "Thanh Long ƒê·∫ßu - Ng√†y t·ªët", days: [6, 14, 22, 30], months: [3, 6, 9, 12], description: "N·∫øu xu·∫•t h√†nh th√¨ n√™n ƒëi s·ªõm ƒë·ªÉ thu·∫≠n l·ª£i h∆°n, c√≥ th·ªÉ ƒëi c·∫ßu t√†i v√¨ m·ªçi vi·ªác d·ªÖ th√†nh c√¥ng." },
            { name: "Thanh Long T√∫c - Ng√†y x·∫•u", days: [8, 16, 24], months: [3, 6, 9, 12], description: "Kh√¥ng n√™n ƒëi xa, kh√¥ng n√™n xu·∫•t h√†nh v√¨ kh√¥ng may m·∫Øn, kh√¥ng nh·∫≠n ƒë∆∞·ª£c t√†i l·ªôc th·∫≠m ch√≠ d√¢y d∆∞a v√†o ki·ªán t·ª•ng c√≤n d·ªÖ b·ªã ƒëu·ªëi l√Ω." },
            { name: "Chu T∆∞·ªõc - Ng√†y x·∫•u", days: [1, 9, 17, 25], months: [3, 6, 9, 12], description: "Xu·∫•t h√†nh hay ƒëi c·∫ßu t√†i ƒë·ªÅu x·∫•u, d·ªÖ b·ªã m·∫•t c·ªßa ho·∫∑c b·ªã ƒëu·ªëi l√Ω khi d√≠nh v√†o ki·ªán c√°o." },
            { name: "B·∫°ch H·ªï T√∫c - Ng√†y x·∫•u", days: [4, 12, 20, 28], months: [3, 6, 9, 12], description: "M·ªçi chuy·ªán ƒë·ªÅu r·∫•t x·∫•u, kh√¥ng n√™n ƒëi xa, kh√¥ng n√™n ch·ªçn l√†m ng√†y xu·∫•t h√†nh." },
            { name: "Huy·ªÅn V≈© - Ng√†y x·∫•u", days: [5, 13, 21, 29], months: [3, 6, 9, 12], description: "N·∫øu xu·∫•t h√†nh ng√†y n√†y th∆∞·ªùng d·ªÖ c√£i nhau, kh√¥ng n√™n ƒëi ƒë√¢u, d·ªÖ g·∫∑p chuy·ªán x·∫•u." }
        ];

        // Danh s√°ch Thi√™n Can v√† ƒê·ªãa Chi
        const thienCan = ['Gi√°p', '·∫§t', 'B√≠nh', 'ƒêinh', 'M·∫≠u', 'K·ª∑', 'Canh', 'T√¢n', 'Nh√¢m', 'Qu√Ω'];
        const diaChi = ['T√Ω', 'S·ª≠u', 'D·∫ßn', 'M√£o', 'Th√¨n', 'T·ªµ', 'Ng·ªç', 'M√πi', 'Th√¢n', 'D·∫≠u', 'Tu·∫•t', 'H·ª£i'];

        // D·ªØ li·ªáu Ng≈© H√†nh
        const nguHanhData = {
            'Gi√°p': 'M·ªôc', '·∫§t': 'M·ªôc',
            'B√≠nh': 'H·ªèa', 'ƒêinh': 'H·ªèa',
            'M·∫≠u': 'Th·ªï', 'K·ª∑': 'Th·ªï',
            'Canh': 'Kim', 'T√¢n': 'Kim',
            'Nh√¢m': 'Th·ªßy', 'Qu√Ω': 'Th·ªßy'
        };

        const nguHanhChi = {
            'T√Ω': 'Th·ªßy', 'S·ª≠u': 'Th·ªï', 'D·∫ßn': 'M·ªôc', 'M√£o': 'M·ªôc',
            'Th√¨n': 'Th·ªï', 'T·ªµ': 'H·ªèa', 'Ng·ªç': 'H·ªèa', 'M√πi': 'Th·ªï',
            'Th√¢n': 'Kim', 'D·∫≠u': 'Kim', 'Tu·∫•t': 'Th·ªï', 'H·ª£i': 'Th·ªßy'
        };

        // Quan h·ªá Ng≈© H√†nh
        const nguHanhRelation = {
            'M·ªôc': { sinh: 'H·ªèa', khac: 'Th·ªï', khacBoi: 'Kim', sinhBoi: 'Th·ªßy' },
            'H·ªèa': { sinh: 'Th·ªï', khac: 'Kim', khacBoi: 'Th·ªßy', sinhBoi: 'M·ªôc' },
            'Th·ªï': { sinh: 'Kim', khac: 'Th·ªßy', khacBoi: 'M·ªôc', sinhBoi: 'H·ªèa' },
            'Kim': { sinh: 'Th·ªßy', khac: 'M·ªôc', khacBoi: 'H·ªèa', sinhBoi: 'Th·ªï' },
            'Th·ªßy': { sinh: 'M·ªôc', khac: 'H·ªèa', khacBoi: 'Th·ªï', sinhBoi: 'Kim' }
        };

        // L·ª•c Xung (ƒê·ªãa Chi xung nhau)
        const lucXung = {
            'T√Ω': 'Ng·ªç', 'Ng·ªç': 'T√Ω',
            'S·ª≠u': 'M√πi', 'M√πi': 'S·ª≠u',
            'D·∫ßn': 'Th√¢n', 'Th√¢n': 'D·∫ßn',
            'M√£o': 'D·∫≠u', 'D·∫≠u': 'M√£o',
            'Th√¨n': 'Tu·∫•t', 'Tu·∫•t': 'Th√¨n',
            'T·ªµ': 'H·ª£i', 'H·ª£i': 'T·ªµ'
        };

        // L·ª•c H·∫°i
        const lucHai = {
            'T√Ω': 'M√πi', 'M√πi': 'T√Ω',
            'S·ª≠u': 'Ng·ªç', 'Ng·ªç': 'S·ª≠u',
            'D·∫ßn': 'T·ªµ', 'T·ªµ': 'D·∫ßn',
            'M√£o': 'Th√¨n', 'Th√¨n': 'M√£o',
            'Th√¢n': 'H·ª£i', 'H·ª£i': 'Th√¢n',
            'D·∫≠u': 'Tu·∫•t', 'Tu·∫•t': 'D·∫≠u'
        };

        // Thi√™n Can Xung
        const thienCanXung = {
            'Gi√°p': 'Canh', 'Canh': 'Gi√°p',
            '·∫§t': 'T√¢n', 'T√¢n': '·∫§t',
            'B√≠nh': 'Nh√¢m', 'Nh√¢m': 'B√≠nh',
            'ƒêinh': 'Qu√Ω', 'Qu√Ω': 'ƒêinh'
        };

        // Thi√™n Can H·ª£p
        const thienCanHop = {
            'Gi√°p': 'K·ª∑', 'K·ª∑': 'Gi√°p',
            '·∫§t': 'Canh', 'Canh': '·∫§t',
            'B√≠nh': 'T√¢n', 'T√¢n': 'B√≠nh',
            'ƒêinh': 'Nh√¢m', 'Nh√¢m': 'ƒêinh',
            'M·∫≠u': 'Qu√Ω', 'Qu√Ω': 'M·∫≠u'
        };

        // Tam H·ª£p ƒê·ªãa Chi
        const tamHop = {
            'T√Ω': ['Th√¨n', 'Th√¢n'],
            'S·ª≠u': ['T·ªµ', 'D·∫≠u'],
            'D·∫ßn': ['Ng·ªç', 'Tu·∫•t'],
            'M√£o': ['M√πi', 'H·ª£i'],
            'Th√¨n': ['T√Ω', 'Th√¢n'],
            'T·ªµ': ['S·ª≠u', 'D·∫≠u'],
            'Ng·ªç': ['D·∫ßn', 'Tu·∫•t'],
            'M√πi': ['M√£o', 'H·ª£i'],
            'Th√¢n': ['T√Ω', 'Th√¨n'],
            'D·∫≠u': ['S·ª≠u', 'T·ªµ'],
            'Tu·∫•t': ['D·∫ßn', 'Ng·ªç'],
            'H·ª£i': ['M√£o', 'M√πi']
        };

        // L·ª•c H·ª£p ƒê·ªãa Chi
        const lucHop = {
            'T√Ω': 'S·ª≠u', 'S·ª≠u': 'T√Ω',
            'D·∫ßn': 'H·ª£i', 'H·ª£i': 'D·∫ßn',
            'M√£o': 'Tu·∫•t', 'Tu·∫•t': 'M√£o',
            'Th√¨n': 'D·∫≠u', 'D·∫≠u': 'Th√¨n',
            'T·ªµ': 'Th√¢n', 'Th√¢n': 'T·ªµ',
            'Ng·ªç': 'M√πi', 'M√πi': 'Ng·ªç'
        };

        // H√†m t√≠nh Thi√™n Can v√† ƒê·ªãa Chi
        function getCanChi(jd, type = 'day', year = null, month = null) {
            if (type === 'day') {
                const canIndex = (jd + 9) % 10;
                const chiIndex = (jd + 1) % 12;
                return `${thienCan[canIndex]} ${diaChi[chiIndex]}`;
            } 
            else if (type === 'month' && year !== null && month !== null) {
                const yearCanIndex = (year + 6) % 10;
                const monthChiIndex = (month + 1) % 12;
                const monthCanIndex = (yearCanIndex * 2 + month + 1) % 10;
                return `${thienCan[monthCanIndex]} ${diaChi[monthChiIndex]}`;
            } 
            else if (type === 'year' && year !== null) {
                const yearCanIndex = (year + 6) % 10;
                const yearChiIndex = (year + 8) % 12;
                return `${thienCan[yearCanIndex]} ${diaChi[yearChiIndex]}`;
            }
            return 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        // H√†m ki·ªÉm tra ng√†y t·ªët/x·∫•u
        function checkGoodBadDay(lunarDay, lunarMonth, lunarLeap) {
            for (let item of goodBadDays) {
                if (item.months.includes(lunarMonth) && item.days.includes(lunarDay)) {
                    return {
                        name: item.name,
                        description: item.description,
                        isGood: item.name.includes("Ng√†y t·ªët")
                    };
                }
            }
            return null;
        }

        // H√†m t√≠nh s·ªë d∆∞ gi·ªù t·ªët/x·∫•u
        function calculateSoDu(ngay, thang, khac) {
            return (ngay + thang + khac - 2) % 6;
        }

        // H√†m x√°c ƒë·ªãnh tr·∫°ng th√°i v√† di·ªÖn gi·∫£i gi·ªù
        function getHourInfo(soDu) {
            let name = '';
            let explanation = '';
            let isGood = false;

            switch (soDu) {
                case 1:
                    name = 'ƒê·∫°i an';
                    explanation = 'M·ªçi vi·ªác ƒë·ªÅu t·ªët, c·∫ßu t√†i ƒëi h∆∞·ªõng T√¢y, Nam. Nh√† c·ª≠a y√™n l√†nh, ng∆∞·ªùi xu·∫•t h√†nh ƒë·ªÅu b√¨nh y√™n.';
                    isGood = true;
                    break;
                case 2:
                    name = 'T·ªëc h·ª∑';
                    explanation = 'Vui s·∫Øp t·ªõi. C·∫ßu t√†i ƒëi h∆∞·ªõng Nam, ƒëi vi·ªác quan nhi·ªÅu may m·∫Øn. Ng∆∞·ªùi xu·∫•t h√†nh ƒë·ªÅu b√¨nh y√™n. ChƒÉn nu√¥i ƒë·ªÅu thu·∫≠n l·ª£i, ng∆∞·ªùi ƒëi c√≥ tin vui v·ªÅ.';
                    isGood = true;
                    break;
                case 3:
                    name = 'L∆∞u mi·ªÅn';
                    explanation = 'Nghi·ªáp kh√≥ th√†nh, c·∫ßu t√†i m·ªù m·ªãt, ki·ªán c√°o n√™n ho√£n l·∫°i. Ng∆∞·ªùi ƒëi ch∆∞a c√≥ tin v·ªÅ. ƒêi h∆∞·ªõng Nam t√¨m nhanh m·ªõi th·∫•y, n√™n ph√≤ng ng·ª´a c√£i c·ªç, mi·ªáng ti·∫øng r·∫•t t·∫ßm th∆∞·ªùng. Vi·ªác l√†m ch·∫≠m, l√¢u la nh∆∞ng vi·ªác g√¨ c≈©ng ch·∫Øc ch·∫Øn.';
                    isGood = false;
                    break;
                case 4:
                    name = 'X√≠ch kh·∫©u';
                    explanation = 'Hay c√£i c·ªç, g√¢y chuy·ªán ƒë√≥i k√©m, ph·∫£i n√™n ƒë·ªÅ ph√≤ng, ng∆∞·ªùi ƒëi n√™n ho√£n l·∫°i, ph√≤ng ng∆∞·ªùi nguy·ªÅn r·ªßa, tr√°nh l√¢y b·ªánh.';
                    isGood = false;
                    break;
                case 5:
                    name = 'Ti·ªÉu c√°t';
                    explanation = 'R·∫•t t·ªët l√†nh, ƒëi th∆∞·ªùng g·∫∑p may m·∫Øn. Bu√¥n b√°n c√≥ l·ªùi, ph·ª• n·ªØ b√°o tin vui m·ª´ng, ng∆∞·ªùi ƒëi s·∫Øp v·ªÅ nh√†, m·ªçi vi·ªác ƒë·ªÅu h√≤a h·ª£p, c√≥ b·ªánh c·∫ßu t√†i s·∫Ω kh·ªèi, ng∆∞·ªùi nh√† ƒë·ªÅu m·∫°nh kh·ªèe.';
                    isGood = true;
                    break;
                case 0:
                case 6:
                    name = 'Tuy·ªát h·ª∑';
                    explanation = 'C·∫ßu t√†i kh√¥ng c√≥ l·ª£i hay b·ªã tr√°i √Ω, ra ƒëi g·∫∑p h·∫°n, vi·ªác quan ph·∫£i ƒë√≤n, g·∫∑p ma qu·ª∑ c√∫ng l·ªÖ m·ªõi an.';
                    isGood = false;
                    break;
            }
            return { name, explanation, isGood };
        }

        // H√†m t√≠nh N·∫°p √Çm (m·ªánh)
        function getNapAm(canChi) {
            const napAmTable = {
                'Gi√°p T√Ω': 'H·∫£i Trung Kim', '·∫§t S·ª≠u': 'H·∫£i Trung Kim',
                'B√≠nh D·∫ßn': 'L∆∞ Trung H·ªèa', 'ƒêinh M√£o': 'L∆∞ Trung H·ªèa',
                'M·∫≠u Th√¨n': 'ƒê·∫°i L√¢m M·ªôc', 'K·ª∑ T·ªµ': 'ƒê·∫°i L√¢m M·ªôc',
                'Canh Ng·ªç': 'L·ªô B√†ng Th·ªï', 'T√¢n M√πi': 'L·ªô B√†ng Th·ªï',
                'Nh√¢m Th√¢n': 'Ki·∫øm Phong Kim', 'Qu√Ω D·∫≠u': 'Ki·∫øm Phong Kim',
                'Gi√°p Tu·∫•t': 'S∆°n ƒê·∫ßu H·ªèa', '·∫§t H·ª£i': 'S∆°n ƒê·∫ßu H·ªèa',
                'B√≠nh T√Ω': 'Gi·∫£n H·∫° Th·ªßy', 'ƒêinh S·ª≠u': 'Gi·∫£n H·∫° Th·ªßy',
                'M·∫≠u D·∫ßn': 'Th√†nh ƒê·∫ßu Th·ªï', 'K·ª∑ M√£o': 'Th√†nh ƒê·∫ßu Th·ªï',
                'Canh Th√¨n': 'B·∫°ch L·∫°p Kim', 'T√¢n T·ªµ': 'B·∫°ch L·∫°p Kim',
                'Nh√¢m Ng·ªç': 'D∆∞∆°ng Li·ªÖu M·ªôc', 'Qu√Ω M√πi': 'D∆∞∆°ng Li·ªÖu M·ªôc',
                'Gi√°p Th√¢n': 'Tuy·ªÅn Trung Th·ªßy', '·∫§t D·∫≠u': 'Tuy·ªÅn Trung Th·ªßy',
                'B√≠nh Tu·∫•t': '·ªêc Th∆∞·ª£ng Th·ªï', 'ƒêinh H·ª£i': '·ªêc Th∆∞·ª£ng Th·ªï',
                'M·∫≠u T√Ω': 'T√≠ch L·ªãch H·ªèa', 'K·ª∑ S·ª≠u': 'T√≠ch L·ªãch H·ªèa',
                'Canh D·∫ßn': 'T√πng B√° M·ªôc', 'T√¢n M√£o': 'T√πng B√° M·ªôc',
                'Nh√¢m Th√¨n': 'Tr∆∞·ªùng L∆∞u Th·ªßy', 'Qu√Ω T·ªµ': 'Tr∆∞·ªùng L∆∞u Th·ªßy',
                'Gi√°p Ng·ªç': 'Sa Trung Kim', '·∫§t M√πi': 'Sa Trung Kim',
                'B√≠nh Th√¢n': 'S∆°n H·∫° H·ªèa', 'ƒêinh D·∫≠u': 'S∆°n H·∫° H·ªèa',
                'M·∫≠u Tu·∫•t': 'B√¨nh ƒê·ªãa M·ªôc', 'K·ª∑ H·ª£i': 'B√¨nh ƒê·ªãa M·ªôc',
                'Canh T√Ω': 'B√≠ch Th∆∞·ª£ng Th·ªï', 'T√¢n S·ª≠u': 'B√≠ch Th∆∞·ª£ng Th·ªï',
                'Nh√¢m D·∫ßn': 'Kim B·∫°c Kim', 'Qu√Ω M√£o': 'Kim B·∫°c Kim',
                'Gi√°p Th√¨n': 'Ph√∫c ƒêƒÉng H·ªèa', '·∫§t T·ªµ': 'Ph√∫c ƒêƒÉng H·ªèa',
                'B√≠nh Ng·ªç': 'Thi√™n H√† Th·ªßy', 'ƒêinh M√πi': 'Thi√™n H√† Th·ªßy',
                'M·∫≠u Th√¢n': 'ƒê·∫°i Tr·∫°ch Th·ªï', 'K·ª∑ D·∫≠u': 'ƒê·∫°i Tr·∫°ch Th·ªï',
                'Canh Tu·∫•t': 'Thoa Xuy·∫øn Kim', 'T√¢n H·ª£i': 'Thoa Xuy·∫øn Kim',
                'Nh√¢m T√Ω': 'Tang ƒê·ªë M·ªôc', 'Qu√Ω S·ª≠u': 'Tang ƒê·ªë M·ªôc',
                'Gi√°p D·∫ßn': 'ƒê·∫°i Kh√™ Th·ªßy', '·∫§t M√£o': 'ƒê·∫°i Kh√™ Th·ªßy',
                'B√≠nh Th√¨n': 'Sa Trung Th·ªï', 'ƒêinh T·ªµ': 'Sa Trung Th·ªï',
                'M·∫≠u Ng·ªç': 'Thi√™n Th∆∞·ª£ng H·ªèa', 'K·ª∑ M√πi': 'Thi√™n Th∆∞·ª£ng H·ªèa',
                'Canh Th√¢n': 'Th·∫°ch L·ª±u M·ªôc', 'T√¢n D·∫≠u': 'Th·∫°ch L·ª±u M·ªôc',
                'Nh√¢m Tu·∫•t': 'ƒê·∫°i H·∫£i Th·ªßy', 'Qu√Ω H·ª£i': 'ƒê·∫°i H·∫£i Th·ªßy'
            };
            return napAmTable[canChi] || 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        // H√†m l·∫•y ng≈© h√†nh t·ª´ N·∫°p √Çm
        function getNguHanhFromNapAm(napAm) {
            if (napAm.includes('Kim')) return 'Kim';
            if (napAm.includes('M·ªôc')) return 'M·ªôc';
            if (napAm.includes('Th·ªßy')) return 'Th·ªßy';
            if (napAm.includes('H·ªèa')) return 'H·ªèa';
            if (napAm.includes('Th·ªï')) return 'Th·ªï';
            return 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        // Thu·∫≠t to√°n c·ªßa H·ªì Ng·ªçc ƒê·ª©c
        const TIME_ZONE = 7.0;

        function jdFromDate(dd, mm, yy) {
            let a = Math.floor((14 - mm) / 12);
            let y = yy + 4800 - a;
            let m = mm + 12 * a - 3;
            let jd = dd + Math.floor((153 * m + 2) / 5) + 365 * y + Math.floor(y / 4) - Math.floor(y / 100) + Math.floor(y / 400) - 32045;
            if (jd < 2299161) {
                jd = dd + Math.floor((153 * m + 2) / 5) + 365 * y + Math.floor(y / 4) - 32083;
            }
            return jd;
        }

        function getNewMoonDay(k, timeZone = TIME_ZONE) {
            let T = k / 1236.85;
            let T2 = T * T;
            let T3 = T2 * T;
            let dr = Math.PI / 180;
            let Jd1 = 2415020.75933 + 29.53058868 * k + 0.0001178 * T2 - 0.000000155 * T3;
            Jd1 = Jd1 + 0.00033 * Math.sin((166.56 + 132.87 * T - 0.009173 * T2) * dr);
            let M = 359.2242 + 29.10535608 * k - 0.0000333 * T2 - 0.00000347 * T3;
            let Mpr = 306.0253 + 385.81691806 * k + 0.0107306 * T2 + 0.00001236 * T3;
            let F = 21.2964 + 390.67050646 * k - 0.0016528 * T2 - 0.00000239 * T3;
            let C1 = (0.1734 - 0.000393 * T) * Math.sin(M * dr) + 0.0021 * Math.sin(2 * dr * M);
            C1 = C1 - 0.4068 * Math.sin(Mpr * dr) + 0.0161 * Math.sin(dr * 2 * Mpr);
            C1 = C1 - 0.0004 * Math.sin(dr * 3 * Mpr);
            C1 = C1 + 0.0104 * Math.sin(dr * 2 * F) - 0.0051 * Math.sin(dr * (M + Mpr));
            C1 = C1 - 0.0074 * Math.sin(dr * (M - Mpr)) + 0.0004 * Math.sin(dr * (2 * F + M));
            C1 = C1 - 0.0004 * Math.sin(dr * (2 * F - M)) - 0.0006 * Math.sin(dr * (2 * F + Mpr));
            C1 = C1 + 0.0010 * Math.sin(dr * (2 * F - Mpr)) + 0.0005 * Math.sin(dr * (2 * Mpr + M));
            let deltat;
            if (T < -11) {
                deltat = 0.001 + 0.000839 * T + 0.0002261 * T2 - 0.00000845 * T3 - 0.000000081 * T * T3;
            } else {
                deltat = -0.000278 + 0.000265 * T + 0.000262 * T2;
            }
            let JdNew = Jd1 + C1 - deltat;
            return Math.floor(JdNew + 0.5 + timeZone / 24);
        }

        function getSunLongitude(jdn, timeZone = TIME_ZONE) {
            let T = (jdn - 2451545.5 - timeZone / 24) / 36525;
            let T2 = T * T;
            let dr = Math.PI / 180;
            let M = 357.52910 + 35999.05030 * T - 0.0001559 * T2 - 0.00000048 * T * T2;
            let L0 = 280.46645 + 36000.76983 * T + 0.0003032 * T2;
            let DL = (1.914600 - 0.004817 * T - 0.000014 * T2) * Math.sin(dr * M);
            DL = DL + (0.019993 - 0.000101 * T) * Math.sin(dr * 2 * M) + 0.000290 * Math.sin(dr * 3 * M);
            let L = L0 + DL;
            L = L * dr;
            L = L - Math.PI * 2 * Math.floor(L / (Math.PI * 2));
            return Math.floor(L / Math.PI * 6);
        }

        function getLunarMonth11(yy, timeZone = TIME_ZONE) {
            let off = jdFromDate(31, 12, yy) - 2415021;
            let k = Math.floor(off / 29.530588853);
            let nm = getNewMoonDay(k, timeZone);
            let sunLong = getSunLongitude(nm, timeZone);
            if (sunLong >= 9) {
                nm = getNewMoonDay(k - 1, timeZone);
            }
            return nm;
        }

        function getLeapMonthOffset(a11, timeZone = TIME_ZONE) {
            let k = Math.floor((a11 - 2415021.076998695) / 29.530588853 + 0.5);
            let last = 0;
            let i = 1;
            let arc = getSunLongitude(getNewMoonDay(k + i, timeZone), timeZone);
            do {
                last = arc;
                i++;
                arc = getSunLongitude(getNewMoonDay(k + i, timeZone), timeZone);
            } while (arc != last && i < 14);
            return i - 1;
        }

        function convertSolar2Lunar(dd, mm, yy, timeZone = TIME_ZONE) {
            let jd = jdFromDate(dd, mm, yy);
            let k = Math.floor((jd - 2415021.076998695) / 29.530588853);
            let monthStart = getNewMoonDay(k + 1, timeZone);
            if (monthStart > jd) {
                monthStart = getNewMoonDay(k, timeZone);
            }
            let a11 = getLunarMonth11(yy, timeZone);
            let b11 = a11;
            let lunarYear = yy;
            if (a11 >= monthStart) {
                lunarYear = yy;
                a11 = getLunarMonth11(yy - 1, timeZone);
            } else {
                b11 = getLunarMonth11(yy + 1, timeZone);
            }
            let lunarDay = jd - monthStart + 1;
            let diff = Math.floor((monthStart - a11) / 29);
            let lunarLeap = 0;
            let lunarMonth = diff + 11;
            if (b11 - a11 > 365) {
                let leapMonthDiff = getLeapMonthOffset(a11, timeZone);
                if (diff >= leapMonthDiff) {
                    lunarMonth = diff + 10;
                    if (diff == leapMonthDiff) {
                        lunarLeap = 1;
                    }
                }
            }
            if (lunarMonth > 12) {
                lunarMonth = lunarMonth - 12;
            }
            if (lunarMonth >= 11 && diff < 4) {
                lunarYear = yy - 1;
            }
            return { day: lunarDay, month: lunarMonth, year: lunarYear, leap: lunarLeap, jd: jd };
        }

        // Bi·∫øn l∆∞u tr·ªØ th√¥ng tin m·ªánh gia ch·ªß
        let userMenh = null;

        // Kh·ªüi t·∫°o dropdown ng√†y sinh
        function initBirthDropdowns() {
            const birthDaySelect = document.getElementById('birthDay');
            const birthMonthSelect = document.getElementById('birthMonth');

            // Populate days (1-31)
            for (let i = 1; i <= 31; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                birthDaySelect.appendChild(option);
            }

            // Populate months (1-12)
            const monthNames = ['Th√°ng 1', 'Th√°ng 2', 'Th√°ng 3', 'Th√°ng 4', 'Th√°ng 5', 'Th√°ng 6',
                                'Th√°ng 7', 'Th√°ng 8', 'Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12'];
            for (let i = 1; i <= 12; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = monthNames[i - 1];
                birthMonthSelect.appendChild(option);
            }
        }

        // H√†m t√≠nh m·ªánh
        function calculateMenh() {
            const day = parseInt(document.getElementById('birthDay').value);
            const month = parseInt(document.getElementById('birthMonth').value);
            const year = parseInt(document.getElementById('birthYear').value);

            if (!day || !month || !year) {
                alert('Vui l√≤ng ch·ªçn ƒë·∫ßy ƒë·ªß ng√†y, th√°ng, nƒÉm sinh!');
                return;
            }

            const lunarResult = convertSolar2Lunar(day, month, year);
            const canChiYear = getCanChi(null, 'year', lunarResult.year);
            const napAm = getNapAm(canChiYear);
            const nguHanh = getNguHanhFromNapAm(napAm);

            userMenh = {
                solarDate: `${day}/${month}/${year}`,
                lunarDate: `${lunarResult.day}/${lunarResult.month}/${lunarResult.year}`,
                canChiYear: canChiYear,
                napAm: napAm,
                nguHanh: nguHanh,
                canYear: canChiYear.split(' ')[0],
                chiYear: canChiYear.split(' ')[1]
            };

            const menhDisplay = document.getElementById('menhDisplay');
            menhDisplay.innerHTML = `
                <p><strong>üìÖ Ng√†y sinh:</strong> ${userMenh.solarDate} (D∆∞∆°ng l·ªãch)</p>
                <p><strong>üåô √Çm l·ªãch:</strong> ${userMenh.lunarDate}</p>
                <p><strong>üéã Can Chi nƒÉm sinh:</strong> ${userMenh.canChiYear}</p>
                <p><strong>‚≠ê M·ªánh:</strong> ${userMenh.napAm} (${userMenh.nguHanh})</p>
            `;
            menhDisplay.style.display = 'block';

            renderCalendar();
        }

        // H√†m x√≥a m·ªánh
        function clearMenh() {
            userMenh = null;
            document.getElementById('birthDay').value = '';
            document.getElementById('birthMonth').value = '';
            document.getElementById('birthYear').value = '';
            document.getElementById('menhDisplay').style.display = 'none';
            renderCalendar();
        }

        // H√†m ph√¢n t√≠ch ng√†y v·ªõi m·ªánh gia ch·ªß (C·∫¢I TI·∫æN)
        function analyzeDayWithMenh(canChiDay) {
            if (!userMenh) return null;

            const [canDay, chiDay] = canChiDay.split(' ');
            const analyses = [];

            // T√≠nh N·∫°p √Çm v√† Ng≈© H√†nh c·ªßa ng√†y
            const napAmDay = getNapAm(canChiDay);
            const nguHanhDay = getNguHanhFromNapAm(napAmDay);

            // 1. Ph√¢n t√≠ch Ng≈© H√†nh (N·∫°p √Çm c·ªßa Tu·ªïi v√† Ng√†y)
            if (nguHanhDay === userMenh.nguHanh) {
                analyses.push({
                    type: 'neutral',
                    title: '‚öñÔ∏è Ng≈© H√†nh ƒê·ªìng Nh·∫•t',
                    content: `Ng≈© h√†nh ng√†y <strong>${nguHanhDay}</strong> (${napAmDay}) ƒë·ªìng nh·∫•t v·ªõi m·ªánh <strong>${userMenh.nguHanh}</strong> (${userMenh.napAm}). Tr·∫°ng th√°i c√¢n b·∫±ng, ph√π h·ª£p cho vi·ªác duy tr√¨, c·ªßng c·ªë.`
                });
            } else if (nguHanhRelation[nguHanhDay]?.sinh === userMenh.nguHanh) {
                analyses.push({
                    type: 'good',
                    title: '‚úÖ Ng√†y Sinh M·ªánh',
                    content: `Ng≈© h√†nh ng√†y <strong>${nguHanhDay}</strong> (${napAmDay}) sinh m·ªánh <strong>${userMenh.nguHanh}</strong> (${userMenh.napAm}). Ng√†y r·∫•t t·ªët, thu·∫≠n l·ª£i cho m·ªçi ho·∫°t ƒë·ªông, nh·∫≠n ƒë∆∞·ª£c nhi·ªÅu h·ªó tr·ª£.`
                });
            } else if (nguHanhRelation[userMenh.nguHanh]?.sinh === nguHanhDay) {
                analyses.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è M·ªánh Sinh Ng√†y',
                    content: `M·ªánh <strong>${userMenh.nguHanh}</strong> (${userMenh.napAm}) sinh ng≈© h√†nh ng√†y <strong>${nguHanhDay}</strong> (${napAmDay}). N√™n th·∫≠n tr·ªçng, tr√°nh ti√™u hao nƒÉng l∆∞·ª£ng, kh√¥ng n√™n l√†m vi·ªác l·ªõn.`
                });
            } else if (nguHanhRelation[nguHanhDay]?.khac === userMenh.nguHanh) {
                analyses.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è Ng√†y Kh·∫Øc M·ªánh',
                    content: `Ng≈© h√†nh ng√†y <strong>${nguHanhDay}</strong> (${napAmDay}) kh·∫Øc m·ªánh <strong>${userMenh.nguHanh}</strong> (${userMenh.napAm}). Ng√†y kh√¥ng thu·∫≠n, n√™n h·∫°n ch·∫ø c√°c ho·∫°t ƒë·ªông quan tr·ªçng, d·ªÖ g·∫∑p tr·ªü ng·∫°i.`
                });
            } else if (nguHanhRelation[userMenh.nguHanh]?.khac === nguHanhDay) {
                analyses.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è M·ªánh Kh·∫Øc Ng√†y',
                    content: `M·ªánh <strong>${userMenh.nguHanh}</strong> (${userMenh.napAm}) kh·∫Øc ng≈© h√†nh ng√†y <strong>${nguHanhDay}</strong> (${napAmDay}). M·ªánh ƒëang ti√™u hao nƒÉng l∆∞·ª£ng, n√™n h·∫°n ch·∫ø c√°c ho·∫°t ƒë·ªông l·ªõn, d·ªÖ m·ªát m·ªèi.`
                });
            }

            // 2. Ph√¢n t√≠ch Thi√™n Can
            if (thienCanXung[canDay] === userMenh.canYear) {
                analyses.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è Thi√™n Can Xung',
                    content: `Thi√™n can ng√†y <strong>${canDay}</strong> xung v·ªõi thi√™n can nƒÉm sinh <strong>${userMenh.canYear}</strong>. N√™n tr√°nh c√°c quy·∫øt ƒë·ªãnh l·ªõn, d·ªÖ g·∫∑p b·∫•t ƒë·ªìng.`
                });
            } else if (thienCanHop[canDay] === userMenh.canYear) {
                analyses.push({
                    type: 'good',
                    title: '‚úÖ Thi√™n Can H·ª£p',
                    content: `Thi√™n can ng√†y <strong>${canDay}</strong> h·ª£p v·ªõi thi√™n can nƒÉm sinh <strong>${userMenh.canYear}</strong>. Ng√†y t·ªët, thu·∫≠n l·ª£i cho m·ªçi vi·ªác, d·ªÖ ƒë∆∞·ª£c gi√∫p ƒë·ª°.`
                });
            } else {
                analyses.push({
                    type: 'neutral',
                    title: '‚öñÔ∏è Thi√™n Can C√¢n B·∫±ng',
                    content: `Thi√™n can ng√†y <strong>${canDay}</strong> kh√¥ng xung kh√¥ng h·ª£p v·ªõi thi√™n can nƒÉm sinh <strong>${userMenh.canYear}</strong>. Tr·∫°ng th√°i c√¢n b·∫±ng, b√¨nh th∆∞·ªùng.`
                });
            }

            // 3. Ph√¢n t√≠ch ƒê·ªãa Chi
            if (lucXung[chiDay] === userMenh.chiYear) {
                analyses.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è L·ª•c Xung (ƒê·ªãa Chi)',
                    content: `ƒê·ªãa chi ng√†y <strong>${chiDay}</strong> xung v·ªõi ƒë·ªãa chi nƒÉm sinh <strong>${userMenh.chiYear}</strong>. Ng√†y n√†y kh√¥ng thu·∫≠n l·ª£i, d·ªÖ g·∫∑p tr·ªü ng·∫°i, tranh c√£i, n√™n tr√°nh c√°c vi·ªác quan tr·ªçng.`
                });
            } else if (lucHai[chiDay] === userMenh.chiYear) {
                analyses.push({
                    type: 'warning',
                    title: '‚ö†Ô∏è L·ª•c H·∫°i (ƒê·ªãa Chi)',
                    content: `ƒê·ªãa chi ng√†y <strong>${chiDay}</strong> h·∫°i v·ªõi ƒë·ªãa chi nƒÉm sinh <strong>${userMenh.chiYear}</strong>. N√™n th·∫≠n tr·ªçng, tr√°nh c√°c vi·ªác quan tr·ªçng, d·ªÖ g·∫∑p phi·ªÅn ph·ª©c.`
                });
            } else if (tamHop[chiDay] && tamHop[chiDay].includes(userMenh.chiYear)) {
                analyses.push({
                    type: 'good',
                    title: '‚úÖ Tam H·ª£p (ƒê·ªãa Chi)',
                    content: `ƒê·ªãa chi ng√†y <strong>${chiDay}</strong> thu·ªôc tam h·ª£p v·ªõi ƒë·ªãa chi nƒÉm sinh <strong>${userMenh.chiYear}</strong>. Ng√†y r·∫•t t·ªët, thu·∫≠n l·ª£i, d·ªÖ th√†nh c√¥ng.`
                });
            } else if (lucHop[chiDay] === userMenh.chiYear) {
                analyses.push({
                    type: 'good',
                    title: '‚úÖ L·ª•c H·ª£p (ƒê·ªãa Chi)',
                    content: `ƒê·ªãa chi ng√†y <strong>${chiDay}</strong> h·ª£p v·ªõi ƒë·ªãa chi nƒÉm sinh <strong>${userMenh.chiYear}</strong>. Ng√†y t·ªët, h√≤a h·ª£p, thu·∫≠n l·ª£i.`
                });
            } else {
                analyses.push({
                    type: 'neutral',
                    title: '‚öñÔ∏è ƒê·ªãa Chi B√¨nh Th∆∞·ªùng',
                    content: `ƒê·ªãa chi ng√†y <strong>${chiDay}</strong> kh√¥ng c√≥ quan h·ªá ƒë·∫∑c bi·ªát v·ªõi ƒë·ªãa chi nƒÉm sinh <strong>${userMenh.chiYear}</strong>. Tr·∫°ng th√°i b√¨nh th∆∞·ªùng.`
                });
            }

            return analyses.length > 0 ? analyses : null;
        }

        // H√†m hi·ªÉn th·ªã th√¥ng tin ng√†y v√† gi·ªù d∆∞·ªõi l·ªãch
        function showDayInfo(solarDate, lunarDate, title, dayDescription, lunarDay, lunarMonth, canChiDay, canChiMonth, canChiYear) {
            const dayInfoContainer = document.getElementById('dayInfo');
            
            // T√≠nh N·∫°p √Çm c·ªßa ng√†y
            const napAmDay = getNapAm(canChiDay);
            const nguHanhDay = getNguHanhFromNapAm(napAmDay);
            
            // Ph√¢n t√≠ch v·ªõi m·ªánh gia ch·ªß (n·∫øu c√≥)
            const menhAnalysis = analyzeDayWithMenh(canChiDay);
            let menhAnalysisHtml = '';
            
            if (menhAnalysis && menhAnalysis.length > 0) {
                menhAnalysisHtml = `
                    <div class="analysis-section">
                        <h4>üîÆ Ph√¢n T√≠ch M·ªánh Gia Ch·ªß v·ªõi Ng√†y ${solarDate}</h4>
                        ${menhAnalysis.map(item => `
                            <div class="analysis-item ${item.type}">
                                <strong>${item.title}</strong>
                                <span>${item.content}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            dayInfoContainer.innerHTML = `
                <h3>${solarDate} (√Çm l·ªãch: ${lunarDate})</h3>
                <p class="day-info"><strong>Ng√†y:</strong> ${canChiDay}, <strong>Th√°ng:</strong> ${canChiMonth}, <strong>NƒÉm:</strong> ${canChiYear}</p>
                <p class="day-info"><strong>M·ªánh ng√†y:</strong> ${napAmDay} (${nguHanhDay})</p>
                <p class="day-info">${title ? `<strong>${title}:</strong> ${dayDescription}` : dayDescription}</p>
                ${menhAnalysisHtml}
                <table class="hours-table">
                    <thead>
                        <tr>
                            <th>Gi·ªù</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Di·ªÖn gi·∫£i</th>
                        </tr>
                    </thead>
                    <tbody id="hoursTableBody"></tbody>
                </table>
            `;

            const hoursTableBody = document.getElementById('hoursTableBody');
            const hours = [
                { names: ['T√Ω', 'Ng·ªç'], times: ['23h00‚Äì01h00', '11h00‚Äì13h00'], khac: 1 },
                { names: ['S·ª≠u', 'M√πi'], times: ['01h00‚Äì03h00', '13h00‚Äì15h00'], khac: 2 },
                { names: ['D·∫ßn', 'Th√¢n'], times: ['03h00‚Äì05h00', '15h00‚Äì17h00'], khac: 3 },
                { names: ['M√£o', 'D·∫≠u'], times: ['05h00‚Äì07h00', '17h00‚Äì19h00'], khac: 4 },
                { names: ['Th√¨n', 'Tu·∫•t'], times: ['07h00‚Äì09h00', '19h00‚Äì21h00'], khac: 5 },
                { names: ['T·ªµ', 'H·ª£i'], times: ['09h00‚Äì11h00', '21h00‚Äì23h00'], khac: 6 }
            ];

            hours.forEach(hour => {
                const soDu = calculateSoDu(lunarDay, lunarMonth, hour.khac);
                const hourInfo = getHourInfo(soDu);
                const row = document.createElement('tr');
                row.className = hourInfo.isGood ? 'good-hour' : 'bad-hour';
                row.innerHTML = `
                    <td>${hour.names[0]} (${hour.times[0]}), ${hour.names[1]} (${hour.times[1]})</td>
                    <td>${hourInfo.name}</td>
                    <td>${hourInfo.explanation}</td>
                `;
                hoursTableBody.appendChild(row);
            });
        }

        function renderCalendar() {
            const month = parseInt(document.getElementById('month').value);
            const year = parseInt(document.getElementById('year').value);
            const calendar = document.getElementById('calendar');
            const currentMonth = document.getElementById('currentMonth');
            
            calendar.innerHTML = '';
            
            // Update current month display
            const monthNames = [
                '', 'Th√°ng 1', 'Th√°ng 2', 'Th√°ng 3', 'Th√°ng 4', 'Th√°ng 5', 'Th√°ng 6',
                'Th√°ng 7', 'Th√°ng 8', 'Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12'
            ];
            const firstDayLunar = convertSolar2Lunar(1, month, year);
            const canChiYear = getCanChi(null, 'year', firstDayLunar.year);
            currentMonth.textContent = `${monthNames[month]} nƒÉm ${year} (${canChiYear})`;

            // Create calendar headers
            const daysOfWeek = ['Ch·ªß Nh·∫≠t', 'Th·ª© Hai', 'Th·ª© Ba', 'Th·ª© T∆∞', 'Th·ª© NƒÉm', 'Th·ª© S√°u', 'Th·ª© B·∫£y'];
            daysOfWeek.forEach(day => {
                const div = document.createElement('div');
                div.className = 'calendar-header';
                div.textContent = day;
                calendar.appendChild(div);
            });

            // Calculate calendar data
            const daysInMonth = new Date(year, month, 0).getDate();
            const firstDay = new Date(year, month - 1, 1).getDay();
            const today = new Date();
            
            // Add empty cells for days before the first day
            for (let i = 0; i < firstDay; i++) {
                const div = document.createElement('div');
                div.className = 'calendar-day empty';
                calendar.appendChild(div);
            }

            // Add days of the month
            let selectedDayElement = null;

            for (let day = 1; day <= daysInMonth; day++) {
                const div = document.createElement('div');
                const dayOfWeek = new Date(year, month - 1, day).getDay();
                
                div.className = 'calendar-day';
                
                // Add weekend class
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    div.classList.add('weekend');
                }
                
                // Add today class
                if (year === today.getFullYear() && month === today.getMonth() + 1 && day === today.getDate()) {
                    div.classList.add('today');
                }
                
                const lunarResult = convertSolar2Lunar(day, month, year);
                const lunarText = lunarResult.leap ? 
                    `${lunarResult.day}/${lunarResult.month} Nhu·∫≠n` : 
                    `${lunarResult.day}/${lunarResult.month}`;
                
                const canChiDay = getCanChi(lunarResult.jd, 'day');
                const canChiMonth = getCanChi(null, 'month', lunarResult.year, lunarResult.month);
                
                const goodBadInfo = checkGoodBadDay(lunarResult.day, lunarResult.month, lunarResult.leap);
                let starHtml = '';
                let title = '';
                let description = 'Ng√†y n√†y kh√¥ng c√≥ th√¥ng tin ƒë·∫∑c bi·ªát v·ªÅ t·ªët/x·∫•u.';
                
                if (goodBadInfo) {
                    starHtml = goodBadInfo.isGood ? 
                        '<span class="good-day">‚≠ê</span>' : 
                        '<span class="bad-day">‚òÖ</span>';
                    title = goodBadInfo.name;
                    description = goodBadInfo.description;
                }

                div.innerHTML = `
                    <div class="solar-date">${day}</div>
                    <div class="lunar-date ${lunarResult.leap ? 'leap' : ''}">${lunarText}</div>
                    <div class="can-chi">${canChiDay}</div>
                    ${starHtml}
                `;
                
                div.onclick = () => {
                    if (selectedDayElement) {
                        selectedDayElement.classList.remove('selected');
                    }
                    div.classList.add('selected');
                    selectedDayElement = div;
                    const canChiYearForDay = getCanChi(null, 'year', lunarResult.year);
                    
                    showDayInfo(
                        `${day}/${month}/${year}`, 
                        lunarText, 
                        title, 
                        description, 
                        lunarResult.day, 
                        lunarResult.month,
                        canChiDay,
                        canChiMonth,
                        canChiYearForDay
                    );
                };
                
                div.style.animationDelay = `${(day - 1) * 0.02}s`;
                
                calendar.appendChild(div);
            }
        }

        // Initialize calendar with current date
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const currentYear = today.getFullYear();
            
            document.getElementById('month').value = currentMonth;
            document.getElementById('year').value = currentYear;
            
            initBirthDropdowns();
            renderCalendar();
        });

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            const monthSelect = document.getElementById('month');
            const yearInput = document.getElementById('year');
            
            if (e.key === 'ArrowLeft') {
                let month = parseInt(monthSelect.value);
                let year = parseInt(yearInput.value);
                
                if (month === 1) {
                    month = 12;
                    year--;
                } else {
                    month--;
                }
                
                monthSelect.value = month;
                yearInput.value = year;
                renderCalendar();
            } else if (e.key === 'ArrowRight') {
                let month = parseInt(monthSelect.value);
                let year = parseInt(yearInput.value);
                
                if (month === 12) {
                    month = 1;
                    year++;
                } else {
                    month++;
                }
                
                monthSelect.value = month;
                yearInput.value = year;
                renderCalendar();
            }
        });
    </script>
</body>
</html>
